<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"><meta name="description" content="Springboot2.xåŸºç¡€æ•™ç¨‹ï¼šè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨è¯¦è§£"><meta name="hexo-theme-A4" content="v1.8.9"><link rel="alternate icon" type="image/webp" href="/avatar.png"><title>mytianya | Dreamâ€™s never sold, Bloodâ€™s never cold</title><link rel="stylesheet" href="/css/highlight/style1.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/markdown.css"><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/ui.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/returnToTop.css"><link rel="stylesheet" href="/css/unicons.css"><link rel="stylesheet" href="/css/toc.css"><link rel="stylesheet" href="/css/returnToLastPage.css"><link rel="stylesheet" href="/css/lightgallery.min.css"><meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="mytianya" type="application/atom+xml">
</head><style>body{background-image:url(/img/leaves-pattern.png)}.paper{background-image:url(/img/leaves-pattern.png)}</style><body><div class="left-toc-container"><nav id="toc" class="bs-docs-sidebar"></nav></div><div class="paper"><div class="shadow-drop-2-bottom paper-main"><div class="header"><div class="header-container"><img style="width:56px;height:auto" alt="^-^" cache-control="max-age=86400" class="header-img" src="/avatar.png" width="10%"><div class="header-content"><a class="logo" href="/">mytianya</a> <span class="description"></span></div></div><ul class="nav"><li><a href="/">é¦–é¡µ</a></li><li><a href="/list/">æ–‡ç« </a></li><li><a href="/about/">å…³äº</a></li><li><a href="/tags/">æ ‡ç­¾</a></li><li><a href="/categories/">åˆ†ç±»</a></li></ul></div><div class="post-main"><div class="post-main-title">Springboot2.xåŸºç¡€æ•™ç¨‹ï¼šè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨è¯¦è§£</div><div class="post-md"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="post-toc-text">è¿‡æ»¤å™¨</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#SpringBoot%E4%BD%BF%E7%94%A8%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="post-toc-text">SpringBootä½¿ç”¨è¿‡æ»¤å™¨</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="post-toc-text">æ‹¦æˆªå™¨</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E4%B8%8E%E6%8B%A6%E6%88%AA%E5%99%A8%E5%8C%BA%E5%88%AB"><span class="post-toc-text">è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨åŒºåˆ«</span></a></li></ol><div class=".article-gallery"><blockquote><p>åœ¨springboot webé¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦å¯¹è¯·æ±‚ä¸å“åº”çš„å†…å®¹è¯·æ±‚æ‹¦æˆªå¤„ç†ï¼Œå¦‚è¿›è¡Œè¯·æ±‚æ—¥å¿—è®°å½•ã€UAæ£€æŸ¥ã€ç”¨æˆ·æƒé™éªŒè¯ã€éæ³•å†…å®¹è¿‡æ»¤ç­‰åŠŸèƒ½ï¼Œè¿™æ—¶å€™è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨å°±æ´¾ä¸Šç”¨åœºã€‚<br>æœ¬æ–‡å¸¦å¤§å®¶è®²è§£springbootå¦‚ä½•ä½¿ç”¨è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨ä»¥åŠä¸¤è€…ä¹‹é—´çš„åŒºåˆ«ã€‚</p></blockquote><h2 id="è¿‡æ»¤å™¨"><a href="#è¿‡æ»¤å™¨" class="headerlink" title="è¿‡æ»¤å™¨"></a>è¿‡æ»¤å™¨</h2><p>Servlet è¿‡æ»¤å™¨å¯ä»¥åŠ¨æ€åœ°æ‹¦æˆªè¯·æ±‚å’Œå“åº”ï¼Œä»¥å˜æ¢æˆ–ä½¿ç”¨åŒ…å«åœ¨è¯·æ±‚æˆ–å“åº”ä¸­çš„ä¿¡æ¯ã€‚è¿‡æ»¤å™¨æ˜¯ä¸€ä¸ªå®ç°äº† javax.servlet.Filter æ¥å£çš„ Java ç±»ã€‚javax.servlet.Filter æ¥å£å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Filter</span> {</span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException {</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest var1, ServletResponse var2, FilterChain var3)</span> <span class="keyword">throws</span> IOException, ServletException;</span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> {</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><table><thead><tr><th>åºå·</th><th>æ–¹æ³•&amp;æå™</th></tr></thead><tbody><tr><td>1</td><td><strong>doFilter</strong><br>è¯¥æ–¹æ³•å®Œæˆå®é™…çš„è¿‡æ»¤æ“ä½œï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚æ–¹æ³•ä¸è¿‡æ»¤å™¨è®¾ç½®åŒ¹é…çš„URLæ—¶ï¼ŒServletå®¹å™¨å°†å…ˆè°ƒç”¨è¿‡æ»¤å™¨çš„doFilteræ–¹æ³•ã€‚FilterChainç”¨æˆ·è®¿é—®åç»­è¿‡æ»¤å™¨ã€‚</td></tr><tr><td>2</td><td><strong>init</strong><br>web åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œweb æœåŠ¡å™¨å°†åˆ›å»ºFilter çš„å®ä¾‹å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å…¶initæ–¹æ³•ï¼Œè¯»å–web.xmlé…ç½®ï¼Œå®Œæˆå¯¹è±¡çš„åˆå§‹åŒ–åŠŸèƒ½ï¼Œä»è€Œä¸ºåç»­çš„ç”¨æˆ·è¯·æ±‚ä½œå¥½æ‹¦æˆªçš„å‡†å¤‡å·¥ä½œï¼ˆfilterå¯¹è±¡åªä¼šåˆ›å»ºä¸€æ¬¡ï¼Œinitæ–¹æ³•ä¹Ÿåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼‰ã€‚å¼€å‘äººå‘˜é€šè¿‡initæ–¹æ³•çš„å‚æ•°ï¼Œå¯è·å¾—ä»£è¡¨å½“å‰filteré…ç½®ä¿¡æ¯çš„FilterConfigå¯¹è±¡ã€‚</td></tr><tr><td>3</td><td><strong>destroy</strong><br>Servletå®¹å™¨åœ¨é”€æ¯è¿‡æ»¤å™¨å®ä¾‹å‰è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­é‡Šæ”¾Servletè¿‡æ»¤å™¨å ç”¨çš„èµ„æºã€‚</td></tr></tbody></table><h2 id="SpringBootä½¿ç”¨è¿‡æ»¤å™¨"><a href="#SpringBootä½¿ç”¨è¿‡æ»¤å™¨" class="headerlink" title="SpringBootä½¿ç”¨è¿‡æ»¤å™¨"></a>SpringBootä½¿ç”¨è¿‡æ»¤å™¨</h2><p>å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„è¿‡æ»¤å™¨</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException {</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException {</span><br><span class="line">         HttpServletRequest req=(HttpServletRequest)servletRequest;</span><br><span class="line">         log.info(req.getRequestURI());</span><br><span class="line">         filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> {</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>ä½¿ç”¨FilterRegistrationBeanæ³¨å†Œè¿‡æ»¤å™¨</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogFilterConfiguration</span> {</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FilterRegistrationBean <span class="title function_">registrationBean</span><span class="params">()</span>{</span><br><span class="line">        FilterRegistrationBean registrationBean=<span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>();</span><br><span class="line">        registrationBean.setFilter(<span class="keyword">new</span> <span class="title class_">LogFilter</span>());</span><br><span class="line">        <span class="comment">//åŒ¹é…çš„è¿‡æ»¤å™¨</span></span><br><span class="line">        registrationBean.addUrlPatterns(<span class="string">"/*"</span>);</span><br><span class="line">        <span class="comment">//è¿‡æ»¤å™¨åç§°</span></span><br><span class="line">        registrationBean.setName(<span class="string">"logFilter"</span>);</span><br><span class="line">        <span class="comment">//è¿‡æ»¤å™¨é¡ºåº</span></span><br><span class="line">        registrationBean.setOrder(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>ä½¿ç”¨Servlet3.0æ³¨è§£å®šä¹‰è¿‡æ»¤å™¨</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(urlPatterns = "/*",filterName = "authFiler")</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException {</span><br><span class="line">        log.info(<span class="string">"è¿›è¡Œæƒé™æ ¡éªŒ........."</span>);</span><br><span class="line">        chain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>ä¸¤ç§æ–¹å¼çš„åŒºåˆ«ï¼š</p><ol><li>WebFilterè¿™ä¸ªæ³¨è§£å¹¶æ²¡æœ‰æŒ‡å®šæ‰§è¡Œé¡ºåºçš„å±æ€§ï¼Œå…¶æ‰§è¡Œé¡ºåºä¾èµ–äºFilterçš„åç§°ï¼Œæ˜¯æ ¹æ®Filterç±»åï¼ˆæ³¨æ„ä¸æ˜¯é…ç½®çš„filterçš„åå­—ï¼‰çš„å­—æ¯é¡ºåºå€’åºæ’åˆ—</li><li>@WebFilteræŒ‡å®šçš„è¿‡æ»¤å™¨ä¼˜å…ˆçº§éƒ½é«˜äºFilterRegistrationBeané…ç½®çš„è¿‡æ»¤å™¨</li><li>FilterRegistrationBeanæ–¹å¼å¯ä»¥æ³¨å…¥SpringBoot IOCå®¹å™¨ä¸­çš„Bean</li></ol><h2 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h2><p>SpringBootæ‹¦æˆªå™¨Interceptorç±»ä¼¼ <strong>é¢å‘åˆ‡é¢ç¼–ç¨‹</strong> ä¸­çš„ <strong>åˆ‡é¢</strong> å’Œ <strong>é€šçŸ¥</strong>ï¼Œæˆ‘ä»¬é€šè¿‡ <strong>åŠ¨æ€ä»£ç†</strong> å¯¹ä¸€ä¸ª <code>service()</code> æ–¹æ³•æ·»åŠ  <strong>é€šçŸ¥</strong> è¿›è¡ŒåŠŸèƒ½å¢å¼ºã€‚æ¯”å¦‚è¯´åœ¨æ–¹æ³•æ‰§è¡Œå‰è¿›è¡Œ <strong>åˆå§‹åŒ–å¤„ç†</strong>ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œåè¿›è¡Œ <strong>åç½®å¤„ç†</strong>ã€‚<strong>æ‹¦æˆªå™¨</strong> çš„æ€æƒ³å’Œ <code>AOP</code> ç±»ä¼¼ï¼ŒåŒºåˆ«å°±æ˜¯ <strong>æ‹¦æˆªå™¨</strong> åªèƒ½å¯¹ <code>Controller</code> çš„ <code>HTTP</code> è¯·æ±‚è¿›è¡Œæ‹¦æˆªã€‚</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">HandlerInterceptor</span> {</span><br><span class="line">    <span class="keyword">default</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, <span class="meta">@Nullable</span> ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, <span class="meta">@Nullable</span> Exception ex)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><table><thead><tr><th>åºå·</th><th>æ–¹æ³•&amp;æå™</th></tr></thead><tbody><tr><td>1</td><td><strong>preHandle</strong><br>è¯¥æ–¹æ³•åœ¨controlleræ¥æ”¶è¯·æ±‚å¤„ç†requestä¹‹å‰æ‰§è¡Œï¼Œè¿”å›å€¼ä¸º booleanï¼Œè¿”å›å€¼ä¸º true æ—¶æ¥ç€æ‰§è¡Œ postHandle() å’Œ afterCompletion() æ–¹æ³•ï¼›å¦‚æœè¿”å›falseåˆ™ä¸­æ–­æ‰§è¡Œã€‚</td></tr><tr><td>2</td><td><strong>postHandle</strong><br>åœ¨ controller å¤„ç†è¯·æ±‚ä¹‹åï¼Œ ModelAndView å¤„ç†å‰æ‰§è¡Œï¼Œå¯ä»¥å¯¹ å“åº”ç»“æœ è¿›è¡Œä¿®æ”¹ã€‚</td></tr><tr><td>3</td><td><strong>afterCompletion</strong><br>åœ¨ DispatchServlet å¯¹æœ¬æ¬¡è¯·æ±‚å¤„ç†å®Œæˆï¼Œå³ç”Ÿæˆ ModelAndView ä¹‹åæ‰§è¡Œã€‚</td></tr></tbody></table><p>å®šä¹‰ä¸€ä¸ªç®€å•çš„æ‹¦æˆªå™¨</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogHandler</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> {</span><br><span class="line">    <span class="keyword">private</span> NamedThreadLocal&lt;Long&gt; startTimeThreadLocal = <span class="keyword">new</span> <span class="title class_">NamedThreadLocal</span>&lt;&gt;(<span class="string">"StopWatch-StartTime"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LogHandler</span><span class="params">()</span> {</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">        <span class="type">long</span> <span class="variable">beginTime</span> <span class="operator">=</span> System.currentTimeMillis();<span class="comment">//1ã€å¼€å§‹æ—¶é—´      </span></span><br><span class="line">        startTimeThreadLocal.set(beginTime);<span class="comment">//çº¿ç¨‹ç»‘å®šå˜é‡ï¼ˆè¯¥æ•°æ®åªæœ‰å½“å‰è¯·æ±‚çš„çº¿ç¨‹å¯è§ï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//ç»§ç»­æµç¨‹</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, <span class="meta">@Nullable</span> ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">long</span> <span class="variable">beginTime</span> <span class="operator">=</span> startTimeThreadLocal.get();<span class="comment">//å¾—åˆ°çº¿ç¨‹ç»‘å®šçš„å±€éƒ¨å˜é‡ï¼ˆå¼€å§‹æ—¶é—´ï¼‰  </span></span><br><span class="line">        <span class="type">long</span> <span class="variable">consumeTime</span> <span class="operator">=</span> endTime - beginTime;</span><br><span class="line">        <span class="comment">//3ã€æ¶ˆè€—çš„æ—¶é—´         </span></span><br><span class="line">        log.info(String.format(<span class="string">"%s consume %d millis"</span>, request.getRequestURI(), consumeTime));</span><br><span class="line">    }    </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æ³¨å†Œæ‹¦æˆªå™¨</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> {</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LogHandler</span>());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨åŒºåˆ«"><a href="#è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨åŒºåˆ«" class="headerlink" title="è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨åŒºåˆ«"></a>è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨åŒºåˆ«</h2><table><thead><tr><th>åºå·</th><th>åŒºåˆ«</th></tr></thead><tbody><tr><td>1</td><td>Filteræ˜¯servletè§„èŒƒï¼Œä½¿ç”¨èŒƒå›´æ˜¯webç¨‹åºï¼Œæ‹¦æˆªå™¨ä¸é™äºwebç¨‹åºï¼Œä¹Ÿå¯ä»¥ç”¨äºApplicationã€Swingç¨‹åºä¸­</td></tr><tr><td>2</td><td>Filteræ˜¯servletè§„èŒƒä¸­å®šä¹‰ï¼Œæ˜¯servletå®¹å™¨æ”¯æŒçš„ã€‚æ‹¦æˆªå™¨æ˜¯Springå®¹å™¨å†…ï¼Œæ˜¯springæ¡†æ¶æ”¯æŒçš„</td></tr><tr><td>3</td><td>æ‹¦æˆªå™¨æ˜¯Springçš„ä¸€ä¸ªç»„ä»¶ï¼Œèƒ½å¤Ÿä½¿ç”¨springä¸­å¯¹è±¡ï¼Œå¦‚Serviceå¯¹è±¡ã€æ•°æ®æºã€äº‹åŠ¡ç®¡ç†ã€é€šè¿‡IOCæ³¨å…¥å®¹å™¨å³å¯ï¼Œfilteråˆ™ä¸èƒ½</td></tr><tr><td>4</td><td>filteråœ¨servletå‰åèµ·ä½œç”¨ï¼Œæ‹¦æˆªå™¨èƒ½å¤Ÿæ·±å…¥æ–¹æ³•çš„å‰åï¼Œå¼‚å¸¸æŠ›å‡ºå‰åã€‚</td></tr><tr><td>5</td><td>åœ¨springbooté¡¹ç›®ä¸­ä¸€èˆ¬ä¼˜å…ˆä½¿ç”¨æ‹¦æˆªå™¨</td></tr></tbody></table><p><strong>åƒé‡Œä¹‹è¡Œï¼Œå§‹äºè¶³ä¸‹ã€‚è¿™é‡Œæ˜¯SpringBootæ•™ç¨‹ç³»åˆ—ç¬¬åäºŒç¯‡ï¼Œæ‰€æœ‰é¡¹ç›®æºç å‡å¯ä»¥åœ¨æˆ‘çš„<a target="_blank" rel="noopener" href="https://github.com/mytianya/springboot-tutorials" title="GitHub">GitHub</a>ä¸Šé¢ä¸‹è½½æºç ã€‚</strong></p></div><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if("undefined"!=typeof lightGallery){var options={selector:".gallery-item"};lightGallery(document.getElementsByClassName(".article-gallery")[0],options)}</script></div><div class="post-meta"><i><span>2023-09-23</span> <span>è¯¥ç¯‡æ–‡ç« è¢« mytianya</span> <span>æ‰“ä¸Šæ ‡ç­¾: <a href="/tags/springboot/">springboot </a></span><span>å½’ä¸ºåˆ†ç±»: <a href="/categories/java/">java</a></span></i></div><br></div><div class="footer"><span>Â© 1949-2024 China</span></div><div class="footer-last"><span>ğŸŒŠDreamâ€™s never sold, Bloodâ€™s never coldğŸŒŠ</span> <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript"></script><script src="/js/toc.js"></script><script src="/js/randomHeaderContent.js"></script><script src="/js/returnToTop.js"></script><script src="/js/returnToLastPage.js"></script><script src="/js/lightgallery.min.js"></script></div><div class="progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div><div class="return-to-last-progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div></div></body><script src="/js/darkmode-js.min.js"></script><script>function addDarkmodeWidget(){new Darkmode({bottom:"53px",right:"unset",left:"42px",time:"0.3s",mixColor:"#fff",backgroundColor:" #e4e4e4 ",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"ğŸŒ“",autoMatchOsTheme:!0}).showWidget()}window.addEventListener("load",addDarkmodeWidget)</script></html>