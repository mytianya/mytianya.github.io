<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"><meta name="description" content="Springboot2.xåŸºç¡€æ•™ç¨‹ï¼šSpringCacheç¼“å­˜æŠ½è±¡è¯¦è§£ä¸Ehcacheã€Redisç¼“å­˜é…ç½®å®æˆ˜"><meta name="hexo-theme-A4" content="v1.8.9"><link rel="alternate icon" type="image/webp" href="/avatar.png"><title>mytianya | Dreamâ€™s never sold, Bloodâ€™s never cold</title><link rel="stylesheet" href="/css/highlight/style1.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/markdown.css"><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/ui.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/returnToTop.css"><link rel="stylesheet" href="/css/unicons.css"><link rel="stylesheet" href="/css/toc.css"><link rel="stylesheet" href="/css/returnToLastPage.css"><link rel="stylesheet" href="/css/lightgallery.min.css"><meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="mytianya" type="application/atom+xml">
</head><style>body{background-image:url(/img/leaves-pattern.png)}.paper{background-image:url(/img/leaves-pattern.png)}</style><body><div class="left-toc-container"><nav id="toc" class="bs-docs-sidebar"></nav></div><div class="paper"><div class="shadow-drop-2-bottom paper-main"><div class="header"><div class="header-container"><img style="width:56px;height:auto" alt="^-^" cache-control="max-age=86400" class="header-img" src="/avatar.png" width="10%"><div class="header-content"><a class="logo" href="/">mytianya</a> <span class="description"></span></div></div><ul class="nav"><li><a href="/">é¦–é¡µ</a></li><li><a href="/list/">æ–‡ç« </a></li><li><a href="/about/">å…³äº</a></li><li><a href="/tags/">æ ‡ç­¾</a></li><li><a href="/categories/">åˆ†ç±»</a></li></ul></div><div class="post-main"><div class="post-main-title">Springboot2.xåŸºç¡€æ•™ç¨‹ï¼šSpringCacheç¼“å­˜æŠ½è±¡è¯¦è§£ä¸Ehcacheã€Redisç¼“å­˜é…ç½®å®æˆ˜</div><div class="post-md"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%BC%93%E5%AD%98%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"><span class="post-toc-text">ç¼“å­˜åŸºæœ¬çŸ¥è¯†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%BC%93%E5%AD%98%E5%91%BD%E4%B8%AD%E7%8E%87"><span class="post-toc-text">ç¼“å­˜å‘½ä¸­ç‡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5"><span class="post-toc-text">ç¼“å­˜ç­–ç•¥</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%BC%93%E5%AD%98%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="post-toc-text">ç¼“å­˜è®¾ç½®å‚æ•°</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Spring%E6%B3%A8%E8%A7%A3%E7%BC%93%E5%AD%98"><span class="post-toc-text">Springæ³¨è§£ç¼“å­˜</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%BC%93%E5%AD%98%E7%9B%B8%E5%85%B3%E6%B3%A8%E8%A7%A3"><span class="post-toc-text">ç¼“å­˜ç›¸å…³æ³¨è§£</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%9B%86%E6%88%90Ehcache%E7%BC%93%E5%AD%98"><span class="post-toc-text">é›†æˆEhcacheç¼“å­˜</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="post-toc-text">å¼•å…¥ä¾èµ–</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AEEhcache%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE"><span class="post-toc-text">é…ç½®Ehcacheç¼“å­˜é…ç½®</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AERedis%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE"><span class="post-toc-text">é…ç½®Redisç¼“å­˜é…ç½®</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96-1"><span class="post-toc-text">å¼•å…¥ä¾èµ–</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Redis%E9%85%8D%E7%BD%AE"><span class="post-toc-text">Redisé…ç½®</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%BC%93%E5%AD%98%E6%B3%A8%E8%A7%A3%E4%BD%BF%E7%94%A8%E4%B8%BE%E4%BE%8B"><span class="post-toc-text">ç¼“å­˜æ³¨è§£ä½¿ç”¨ä¸¾ä¾‹</span></a></li></ol><div class=".article-gallery"><blockquote><p>åœ¨è®¡ç®—æœºå‘å±•å²ä¸­ä¸€å°è®¡ç®—æœºåªéœ€è¦å¤–éƒ¨å­˜å‚¨å™¨å°±èƒ½è¿è¡Œï¼Œä½†æ˜¯åœ¨å®é™…ä¸­ç£ç›˜çš„è¯»å–æ•°æ®çš„é€Ÿåº¦å¾€å¾€è·Ÿä¸ä¸ŠCPUçš„è¿ç®—é€Ÿåº¦ï¼Œå› æ­¤å¼•å…¥çš„å†…å­˜ä½œä¸ºCPUå’Œå¤–éƒ¨å­˜å‚¨å™¨ä¹‹é—´çš„ç¼“å†²åŒºåŸŸã€‚<br>åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹æ•°æ®åº“æ•°æ®çš„æŸ¥è¯¢é€Ÿåº¦è¿œè¿œæ¯”ä¸ä¸Šæ•°æ®åœ¨å†…å­˜ä¸­çš„è®¿é—®é€Ÿåº¦ï¼Œå› æ­¤æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ç¼“å­˜æ¥æé«˜çƒ­ç‚¹æ•°æ®çš„è®¿é—®é€Ÿåº¦ï¼Œç¼“å­˜å¯è°“æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­æœ€ä¼Ÿå¤§çš„å‘æ˜ã€‚</p></blockquote><h2 id="ç¼“å­˜åŸºæœ¬çŸ¥è¯†"><a href="#ç¼“å­˜åŸºæœ¬çŸ¥è¯†" class="headerlink" title="ç¼“å­˜åŸºæœ¬çŸ¥è¯†"></a>ç¼“å­˜åŸºæœ¬çŸ¥è¯†</h2><h3 id="ç¼“å­˜å‘½ä¸­ç‡"><a href="#ç¼“å­˜å‘½ä¸­ç‡" class="headerlink" title="ç¼“å­˜å‘½ä¸­ç‡"></a>ç¼“å­˜å‘½ä¸­ç‡</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å‘½ä¸­ç‡=ä»ç¼“å­˜ä¸­è¯»å–çš„é€Ÿåº¦/æ€»è¯»å–æ¬¡æ•°(ä»ç¼“å­˜è¯»å–æ¬¡æ•°+ä»æ…¢é€Ÿè®¾å¤‡è¯»å–æ¬¡æ•°)</span><br><span class="line">Missç‡=æ²¡æœ‰ä»ç¼“å­˜ä¸­è¯»å–çš„é€Ÿåº¦/æ€»è¯»å–æ¬¡æ•°(ä»ç¼“å­˜è¯»å–æ¬¡æ•°+ä»æ…¢é€Ÿè®¾å¤‡è¯»å–æ¬¡æ•°)</span><br></pre></td></tr></tbody></table></figure><p>è¿™æ˜¯ä¸€ä¸ªç¼“å­˜éå¸¸é‡è¦çš„ä¸€ä¸ªæ€§èƒ½æŒ‡æ ‡ï¼Œå¾€å¾€å‘½ä¸­ç‡è¶Šé«˜è¡¨ç¤ºç¼“å­˜ä½œç”¨è¶Šå¤§</p><h3 id="ç¼“å­˜ç­–ç•¥"><a href="#ç¼“å­˜ç­–ç•¥" class="headerlink" title="ç¼“å­˜ç­–ç•¥"></a>ç¼“å­˜ç­–ç•¥</h3><p>ç§»é™¤ç­–ç•¥ï¼Œå³å¦‚æœç¼“å­˜æ»¡äº†ï¼Œå¦‚ä½•ä»ç¼“å­˜ä¸­ç§»é™¤æ•°æ®çš„ç­–ç•¥</p><ol><li>FIFO(First in First Out):å…ˆè¿›å…ˆå‡ºç®—æ³•ï¼Œå³å…ˆæ”¾å…¥ç¼“å­˜çš„æ•°æ®å…ˆè¢«ç§»é™¤</li><li>LRU(Least Recently used)ï¼šæœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ä¼˜å…ˆè¢«æœ‰é™ç§»é™¤</li><li>LFU(Least Frequently used): æœ€å°‘è¢«ä½¿ç”¨çš„æ•°æ®æœ‰é™è¢«ç§»é™¤</li></ol><h3 id="ç¼“å­˜è®¾ç½®å‚æ•°"><a href="#ç¼“å­˜è®¾ç½®å‚æ•°" class="headerlink" title="ç¼“å­˜è®¾ç½®å‚æ•°"></a>ç¼“å­˜è®¾ç½®å‚æ•°</h3><ol><li>TTL(Time To live): å­˜æ´»æœŸï¼Œå³ä»ç¼“å­˜ä¸­åˆ›å»ºæ—¶é—´ç‚¹å¼€å§‹ç›´åˆ°å®ƒåˆ°æœŸçš„ä¸€ä¸ªæ—¶é—´æ®µï¼ˆä¸ç®¡åœ¨è¿™ä¸ªæ—¶é—´æ®µå†…æœ‰æ²¡æœ‰è®¿é—®éƒ½å°†è¿‡æœŸï¼‰</li><li>TTI(Time To Idle): ç©ºé—²æœŸï¼Œå³ä¸€ä¸ªæ•°æ®å¤šä¹…æ²¡è¢«è®¿é—®å°†ä»ç¼“å­˜ä¸­ç§»é™¤çš„æ—¶é—´ã€‚</li><li>æœ€å¤šè¢«ç¼“å­˜çš„å…ƒç´ </li></ol><h2 id="Springæ³¨è§£ç¼“å­˜"><a href="#Springæ³¨è§£ç¼“å­˜" class="headerlink" title="Springæ³¨è§£ç¼“å­˜"></a>Springæ³¨è§£ç¼“å­˜</h2><p>Spring 3.1ä¹‹åï¼Œå¼•å…¥äº†æ³¨è§£ç¼“å­˜æŠ€æœ¯ï¼Œå…¶æœ¬è´¨ä¸Šä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„ç¼“å­˜å®ç°æ–¹æ¡ˆï¼Œè€Œæ˜¯ä¸€ä¸ªå¯¹ç¼“å­˜ä½¿ç”¨çš„æŠ½è±¡ï¼Œé€šè¿‡åœ¨æ—¢æœ‰ä»£ç ä¸­æ·»åŠ å°‘é‡è‡ªå®šä¹‰çš„å„ç§annotationï¼Œå³èƒ½å¤Ÿè¾¾åˆ°ä½¿ç”¨ç¼“å­˜å¯¹è±¡å’Œç¼“å­˜æ–¹æ³•çš„è¿”å›å¯¹è±¡çš„æ•ˆæœã€‚Springçš„ç¼“å­˜æŠ€æœ¯å…·å¤‡ç›¸å½“çš„çµæ´»æ€§ï¼Œä¸ä»…èƒ½å¤Ÿä½¿ç”¨SpELï¼ˆSpring Expression Languageï¼‰æ¥å®šä¹‰ç¼“å­˜çš„keyå’Œå„ç§conditionï¼Œè¿˜æä¾›å¼€ç®±å³ç”¨çš„ç¼“å­˜ä¸´æ—¶å­˜å‚¨æ–¹æ¡ˆï¼Œä¹Ÿæ”¯æŒå’Œä¸»æµçš„ä¸“ä¸šç¼“å­˜é›†æˆã€‚å…¶ç‰¹ç‚¹æ€»ç»“å¦‚ä¸‹ï¼š</p><ol><li>å°‘é‡çš„é…ç½®annotationæ³¨é‡Šå³å¯ä½¿å¾—æ—¢æœ‰ä»£ç æ”¯æŒç¼“å­˜ï¼›</li><li>æ”¯æŒå¼€ç®±å³ç”¨ï¼Œä¸ç”¨å®‰è£…å’Œéƒ¨ç½²é¢å¤–çš„ç¬¬ä¸‰æ–¹ç»„ä»¶å³å¯ä½¿ç”¨ç¼“å­˜ï¼›</li><li>æ”¯æŒSpring Express Languageï¼ˆSpELï¼‰ï¼Œèƒ½ä½¿ç”¨å¯¹è±¡çš„ä»»ä½•å±æ€§æˆ–è€…æ–¹æ³•æ¥å®šä¹‰ç¼“å­˜çš„keyå’Œä½¿ç”¨è§„åˆ™æ¡ä»¶ï¼›</li><li>æ”¯æŒè‡ªå®šä¹‰keyå’Œè‡ªå®šä¹‰ç¼“å­˜ç®¡ç†è€…ï¼Œå…·æœ‰ç›¸å½“çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚</li></ol><h3 id="ç¼“å­˜ç›¸å…³æ³¨è§£"><a href="#ç¼“å­˜ç›¸å…³æ³¨è§£" class="headerlink" title="ç¼“å­˜ç›¸å…³æ³¨è§£"></a>ç¼“å­˜ç›¸å…³æ³¨è§£</h3><table><thead><tr><th>æ³¨è§£</th><th>è¯´æ˜</th><th>é…ç½®å‚æ•°</th></tr></thead><tbody><tr><td>@Cacheable</td><td>æ ¹æ®æ–¹æ³•çš„è¯·æ±‚å‚æ•°å¯¹å…¶ç»“æœè¿›è¡Œç¼“å­˜</td><td>valueï¼šç¼“å­˜çš„åç§°ï¼›keyï¼šç¼“å­˜çš„ keyï¼Œå¯ä»¥ä¸ºç©ºï¼Œä¹Ÿå¯æŒ‰ç…§SpEL è¡¨è¾¾å¼ç¼–å†™ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤æŒ‰ç…§æ–¹æ³•çš„æ‰€æœ‰å‚æ•°è¿›è¡Œç»„åˆï¼› conditionï¼šç¼“å­˜çš„æ¡ä»¶ï¼Œå¯ä»¥ä¸ºç©ºï¼Œä½¿ç”¨ SpEL ç¼–å†™ï¼Œè¿”å› true æˆ–è€… falseï¼Œåªæœ‰ä¸º true æ‰è¿›è¡Œç¼“å­˜</td></tr><tr><td>@CachePut</td><td>æ ¹æ®æ–¹æ³•çš„è¯·æ±‚å‚æ•°å¯¹å…¶ç»“æœè¿›è¡Œç¼“å­˜ï¼Œå’Œ @Cacheable ä¸åŒçš„æ˜¯ï¼Œå®ƒæ¯æ¬¡éƒ½ä¼šè§¦å‘çœŸå®æ–¹æ³•çš„è°ƒç”¨</td><td>valueï¼šç¼“å­˜çš„åç§°ï¼›keyï¼šç¼“å­˜çš„ keyï¼Œå¯ä»¥ä¸ºç©ºï¼Œä¹Ÿå¯æŒ‰ç…§SpEL è¡¨è¾¾å¼ç¼–å†™ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤æŒ‰ç…§æ–¹æ³•çš„æ‰€æœ‰å‚æ•°è¿›è¡Œç»„åˆï¼› conditionï¼šç¼“å­˜çš„æ¡ä»¶ï¼Œå¯ä»¥ä¸ºç©ºï¼Œä½¿ç”¨ SpEL ç¼–å†™ï¼Œè¿”å› true æˆ–è€… falseï¼Œåªæœ‰ä¸º true æ‰è¿›è¡Œç¼“å­˜</td></tr><tr><td>@CacheEvict</td><td>å¤Ÿæ ¹æ®ä¸€å®šçš„æ¡ä»¶å¯¹ç¼“å­˜è¿›è¡Œæ¸…ç©º</td><td>valueï¼šç¼“å­˜çš„åç§°ï¼›keyï¼šç¼“å­˜çš„ keyï¼Œå¯ä»¥ä¸ºç©ºï¼Œä¹Ÿå¯æŒ‰ç…§SpEL è¡¨è¾¾å¼ç¼–å†™ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤æŒ‰ç…§æ–¹æ³•çš„æ‰€æœ‰å‚æ•°è¿›è¡Œç»„åˆï¼›conditionï¼šç¼“å­˜çš„æ¡ä»¶ï¼Œå¯ä»¥ä¸ºç©ºï¼Œä½¿ç”¨ SpEL ç¼–å†™ï¼Œè¿”å› true æˆ–è€… falseï¼Œåªæœ‰ä¸º true æ‰è¿›è¡Œç¼“å­˜ï¼› allEntriesï¼šæ˜¯å¦æ¸…ç©ºæ‰€æœ‰ç¼“å­˜å†…å®¹ï¼Œé»˜è®¤ä¸º falseï¼Œå¦‚æœæŒ‡å®šä¸º trueï¼Œåˆ™æ–¹æ³•è°ƒç”¨åå°†ç«‹å³æ¸…ç©ºæ‰€æœ‰ç¼“å­˜ï¼› beforeInvocationï¼šæ˜¯å¦åœ¨æ–¹æ³•æ‰§è¡Œå‰å°±æ¸…ç©ºï¼Œé»˜è®¤ä¸º falseï¼Œå¦‚æœæŒ‡å®šä¸º trueï¼Œåˆ™åœ¨æ–¹æ³•è¿˜æ²¡æœ‰æ‰§è¡Œçš„æ—¶å€™å°±æ¸…ç©ºç¼“å­˜ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœæ–¹æ³•æ‰§è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™ä¸ä¼šæ¸…ç©ºç¼“å­˜</td></tr></tbody></table><h3 id="é›†æˆEhcacheç¼“å­˜"><a href="#é›†æˆEhcacheç¼“å­˜" class="headerlink" title="é›†æˆEhcacheç¼“å­˜"></a>é›†æˆEhcacheç¼“å­˜</h3><p>EhCacheæ˜¯ä¸€ä¸ªæ¯”è¾ƒæˆç†Ÿçš„Javaç¼“å­˜æ¡†æ¶ï¼Œæœ€æ—©ä»hibernateå‘å±•è€Œæ¥ï¼Œ æ˜¯è¿›ç¨‹ä¸­çš„ç¼“å­˜ç³»ç»Ÿï¼Œå®ƒæä¾›äº†ç”¨å†…å­˜ï¼Œç£ç›˜æ–‡ä»¶å­˜å‚¨ï¼Œä»¥åŠåˆ†å¸ƒå¼å­˜å‚¨æ–¹å¼ç­‰å¤šç§çµæ´»çš„cacheç®¡ç†æ–¹æ¡ˆï¼Œå¿«é€Ÿç®€å•ã€‚<br>Springbootå¯¹ehcacheçš„ä½¿ç”¨éå¸¸æ”¯æŒï¼Œæ‰€ä»¥åœ¨Springbootä¸­åªéœ€åšäº›é…ç½®å°±å¯ä½¿ç”¨ï¼Œä¸”ä½¿ç”¨æ–¹å¼ä¹Ÿç®€æ˜“ã€‚</p><h4 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sf.ehcache<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h4 id="é…ç½®Ehcacheç¼“å­˜é…ç½®"><a href="#é…ç½®Ehcacheç¼“å­˜é…ç½®" class="headerlink" title="é…ç½®Ehcacheç¼“å­˜é…ç½®"></a>é…ç½®Ehcacheç¼“å­˜é…ç½®</h4><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ehcache</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">"../config/ehcache.xsd"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ç£ç›˜è·¯å¾„ï¼Œå†…å­˜æ»¡äº†å­˜æ”¾ä½ç½®--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">"caches"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cache</span> <span class="attr">name</span>=<span class="string">"users"</span></span></span><br><span class="line"><span class="tag"> 	&lt;!<span class="attr">--</span> <span class="attr">æœ€å¤šå­˜å‚¨çš„å…ƒç´ --</span>&gt;</span></span><br><span class="line">	maxElementsInMemory="10000"</span><br><span class="line">	<span class="comment">&lt;!--ç¼“å­˜ä¸­å¯¹è±¡æ˜¯å¦æ°¸ä¹…æœ‰æ•ˆ--&gt;</span></span><br><span class="line">    eternal="false"</span><br><span class="line">	<span class="comment">&lt;!--ç¼“å­˜æ•°æ®åœ¨å¤±æ•ˆå‰çš„å…è®¸é—²ç½®æ—¶é—´(å•ä½:ç§’)ï¼Œä»…å½“eternal=falseæ—¶ä½¿ç”¨,é»˜è®¤å€¼æ˜¯0è¡¨ç¤ºå¯é—²ç½®æ—¶é—´æ— ç©·å¤§,è‹¥è¶…è¿‡è¿™ä¸ªæ—¶é—´æ²¡æœ‰è®¿é—®æ­¤Cacheä¸­çš„æŸä¸ªå…ƒç´ ,é‚£ä¹ˆæ­¤å…ƒç´ å°†è¢«ä»Cacheä¸­æ¸…é™¤--&gt;</span></span><br><span class="line">    timeToIdleSeconds="120"</span><br><span class="line">	<span class="comment">&lt;!--ç¼“å­˜æ•°æ®çš„æ€»çš„å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ï¼Œä»…å½“eternal=falseæ—¶ä½¿ç”¨ï¼Œä»åˆ›å»ºå¼€å§‹è®¡æ—¶ï¼Œå¤±æ•ˆç»“æŸã€‚--&gt;</span></span><br><span class="line">    timeToLiveSeconds="120"</span><br><span class="line">	<span class="comment">&lt;!--ç£ç›˜ç¼“å­˜ä¸­æœ€å¤šå¯ä»¥å­˜æ”¾çš„å…ƒç´ æ•°é‡,0è¡¨ç¤ºæ— ç©·å¤§--&gt;</span></span><br><span class="line">    maxElementsOnDisk="10000000"</span><br><span class="line">    diskExpiryThreadIntervalSeconds="120"</span><br><span class="line">	<span class="comment">&lt;!--ç¼“å­˜ç­–ç•¥--&gt;</span></span><br><span class="line">    memoryStoreEvictionPolicy="LRU"&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">persistence</span> <span class="attr">strategy</span>=<span class="string">"localTempSwap"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">cache</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>applicatin.ymlé…ç½®ehcacheåœ°å€ï¼Œåœ¨springbootå¯åŠ¨ç±»åŠ ä¸Š@EnableCachingæ³¨è§£</p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  cache:</span><br><span class="line">    ehcache:</span><br><span class="line">      config: classpath:ehcache.xml</span><br><span class="line">    type: ehcache</span><br></pre></td></tr></tbody></table></figure><h3 id="é…ç½®Redisç¼“å­˜é…ç½®"><a href="#é…ç½®Redisç¼“å­˜é…ç½®" class="headerlink" title="é…ç½®Redisç¼“å­˜é…ç½®"></a>é…ç½®Redisç¼“å­˜é…ç½®</h3><h4 id="å¼•å…¥ä¾èµ–-1"><a href="#å¼•å…¥ä¾èµ–-1" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h4 id="Redisé…ç½®"><a href="#Redisé…ç½®" class="headerlink" title="Redisé…ç½®"></a>Redisé…ç½®</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableCaching</span><span class="comment">//å¼€å¯ç¼“å­˜</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfig</span> <span class="keyword">extends</span> <span class="title class_">CachingConfigurerSupport</span> {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger log= LoggerFactory.getLogger(RedisConfig.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CacheManager <span class="title function_">cacheManager</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> {</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RedisCacheManager</span>(</span><br><span class="line">                RedisCacheWriter.nonLockingRedisCacheWriter(redisConnectionFactory),</span><br><span class="line">                <span class="built_in">this</span>.getRedisCacheConfigurationWithTtl(<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>), <span class="comment">// é»˜è®¤ç­–ç•¥ï¼Œæœªé…ç½®çš„ key ä¼šä½¿ç”¨è¿™ä¸ª</span></span><br><span class="line">                <span class="built_in">this</span>.getRedisCacheConfigurationMap() <span class="comment">// æŒ‡å®š key ç­–ç•¥</span></span><br><span class="line">        );</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, RedisCacheConfiguration&gt; <span class="title function_">getRedisCacheConfigurationMap</span><span class="params">()</span> {</span><br><span class="line">        Map&lt;String, RedisCacheConfiguration&gt; redisCacheConfigurationMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//å¯ä»¥è¿›è¡Œè¿‡æœŸæ—¶é—´é…ç½®</span></span><br><span class="line">        redisCacheConfigurationMap.put(<span class="string">"24h"</span>, <span class="built_in">this</span>.getRedisCacheConfigurationWithTtl(<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>));</span><br><span class="line">        redisCacheConfigurationMap.put(<span class="string">"30d"</span>, <span class="built_in">this</span>.getRedisCacheConfigurationWithTtl(<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>));</span><br><span class="line">        <span class="keyword">return</span> redisCacheConfigurationMap;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RedisCacheConfiguration <span class="title function_">getRedisCacheConfigurationWithTtl</span><span class="params">(Integer seconds)</span> {</span><br><span class="line">        Jackson2JsonRedisSerializer&lt;Object&gt; jackson2JsonRedisSerializer = <span class="keyword">new</span> <span class="title class_">Jackson2JsonRedisSerializer</span>&lt;&gt;(Object.class);</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">om</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line"></span><br><span class="line">        <span class="type">RedisCacheConfiguration</span> <span class="variable">redisCacheConfiguration</span> <span class="operator">=</span> RedisCacheConfiguration.defaultCacheConfig();</span><br><span class="line"></span><br><span class="line">        redisCacheConfiguration = redisCacheConfiguration.serializeValuesWith(</span><br><span class="line">                RedisSerializationContext</span><br><span class="line">                        .SerializationPair</span><br><span class="line">                        .fromSerializer(jackson2JsonRedisSerializer)</span><br><span class="line">        ).entryTtl(Duration.ofSeconds(seconds));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è‡ªå®šä¹‰å‰ç¼€ é»˜è®¤ä¸ºä¸­é—´ä¸¤ä¸ªï¼š</span></span><br><span class="line">        redisCacheConfiguration = redisCacheConfiguration.computePrefixWith(myKeyPrefix());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redisCacheConfiguration;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼“å­˜å‰ç¼€ï¼ˆè¿½åŠ ä¸€ä¸ªå†’å· : ï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> CacheKeyPrefix <span class="title function_">myKeyPrefix</span><span class="params">()</span>{</span><br><span class="line">        <span class="keyword">return</span> (name) -&gt; {</span><br><span class="line">            <span class="keyword">return</span> name +<span class="string">":"</span>;</span><br><span class="line">        };</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”ŸæˆKeyè§„åˆ™</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> KeyGenerator <span class="title function_">wiselyKeyGenerator</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">KeyGenerator</span>() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Object <span class="title function_">generate</span><span class="params">(Object target, Method method, Object... params)</span> {</span><br><span class="line">                <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                sb.append(target.getClass().getName());</span><br><span class="line">                sb.append(<span class="string">"."</span> + method.getName());</span><br><span class="line">                <span class="keyword">if</span>(params==<span class="literal">null</span>||params.length==<span class="number">0</span>||params[<span class="number">0</span>]==<span class="literal">null</span>){</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                }</span><br><span class="line">                <span class="type">String</span> <span class="variable">join</span> <span class="operator">=</span> String.join(<span class="string">"&amp;"</span>, Arrays.stream(params).map(Object::toString).collect(Collectors.toList()));</span><br><span class="line">                <span class="type">String</span> <span class="variable">format</span> <span class="operator">=</span> String.format(<span class="string">"%s{%s}"</span>, sb.toString(), join);</span><br><span class="line">                <span class="comment">//log.info("ç¼“å­˜keyï¼š" + format);</span></span><br><span class="line">                <span class="keyword">return</span> format;</span><br><span class="line">            }</span><br><span class="line">        };</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;String, String&gt; <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span> {</span><br><span class="line">        RedisTemplate&lt;String, String&gt; redisTemplate = <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>&lt;String, String&gt;();</span><br><span class="line">        redisTemplate.setConnectionFactory(factory);</span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼“å­˜å¼‚å¸¸å¤„ç†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> CacheErrorHandler <span class="title function_">errorHandler</span><span class="params">()</span> {</span><br><span class="line">        <span class="type">CacheErrorHandler</span> <span class="variable">cacheErrorHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CacheErrorHandler</span>() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleCacheGetError</span><span class="params">(RuntimeException e, Cache cache, Object key)</span> {</span><br><span class="line">                log.info(<span class="string">"redisç¼“å­˜è·å–å¼‚å¸¸ï¼š"</span>+ key);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleCachePutError</span><span class="params">(RuntimeException e, Cache cache, Object key, Object value)</span> {</span><br><span class="line">                log.info(<span class="string">"redisç¼“å­˜æ·»åŠ å¼‚å¸¸ï¼š"</span>+ key);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleCacheEvictError</span><span class="params">(RuntimeException e, Cache cache, Object key)</span> {</span><br><span class="line">                log.info(<span class="string">"redisç¼“å­˜åˆ é™¤å¼‚å¸¸ï¼š"</span>+ key);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleCacheClearError</span><span class="params">(RuntimeException e, Cache cache)</span> {</span><br><span class="line">                log.info(<span class="string">"redisç¼“å­˜æ¸…ç†å¼‚å¸¸"</span>);</span><br><span class="line">            }</span><br><span class="line">        };</span><br><span class="line">        <span class="keyword">return</span> cacheErrorHandler;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>applicatin.ymlé…ç½®Redisè¿æ¥ä¿¡æ¯</p><figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="string">5000ms</span></span><br><span class="line">    <span class="attr">lettuce:</span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">5</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="number">-1</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">cache:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">redis</span></span><br></pre></td></tr></tbody></table></figure><h2 id="ç¼“å­˜æ³¨è§£ä½¿ç”¨ä¸¾ä¾‹"><a href="#ç¼“å­˜æ³¨è§£ä½¿ç”¨ä¸¾ä¾‹" class="headerlink" title="ç¼“å­˜æ³¨è§£ä½¿ç”¨ä¸¾ä¾‹"></a>ç¼“å­˜æ³¨è§£ä½¿ç”¨ä¸¾ä¾‹</h2><p>å¯¹ç”¨æˆ·çš„æŸ¥è¯¢ã€æ–°å¢ã€åˆ é™¤ä½¿ç”¨ç¼“å­˜ï¼Œä»¥åŠæ›´æ–°ç¼“å­˜</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> {</span><br><span class="line">    <span class="meta">@Cacheable(value = "users",key = "#userDO.id")</span></span><br><span class="line">    List&lt;UserDO&gt; <span class="title function_">queryUsers</span><span class="params">(UserDO userDO)</span>;</span><br><span class="line">    <span class="meta">@CachePut(value = "users",key ="#userDO.id" )</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">(UserDO userDO)</span>;</span><br><span class="line">    <span class="meta">@CacheEvict(value = "users",key = "#userDO.id")</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">removeUser</span><span class="params">(UserDO userDO)</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>åƒé‡Œä¹‹è¡Œï¼Œå§‹äºè¶³ä¸‹ã€‚è¿™é‡Œæ˜¯SpringBootæ•™ç¨‹ç³»åˆ—ç¬¬åäº”ç¯‡ï¼Œæ‰€æœ‰é¡¹ç›®æºç å‡å¯ä»¥åœ¨æˆ‘çš„<a target="_blank" rel="noopener" href="https://github.com/mytianya/springboot-tutorials" title="GitHub">GitHub</a>ä¸Šé¢ä¸‹è½½æºç ã€‚</strong></p></div><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if("undefined"!=typeof lightGallery){var options={selector:".gallery-item"};lightGallery(document.getElementsByClassName(".article-gallery")[0],options)}</script></div><div class="post-meta"><i><span>2023-09-25</span> <span>è¯¥ç¯‡æ–‡ç« è¢« mytianya</span> <span>æ‰“ä¸Šæ ‡ç­¾: <a href="/tags/springboot/">springboot </a></span><span>å½’ä¸ºåˆ†ç±»: <a href="/categories/java/">java</a></span></i></div><br></div><div class="footer"><span>Â© 1949-2024 China</span></div><div class="footer-last"><span>ğŸŒŠDreamâ€™s never sold, Bloodâ€™s never coldğŸŒŠ</span> <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript"></script><script src="/js/toc.js"></script><script src="/js/randomHeaderContent.js"></script><script src="/js/returnToTop.js"></script><script src="/js/returnToLastPage.js"></script><script src="/js/lightgallery.min.js"></script></div><div class="progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div><div class="return-to-last-progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div></div></body><script src="/js/darkmode-js.min.js"></script><script>function addDarkmodeWidget(){new Darkmode({bottom:"53px",right:"unset",left:"42px",time:"0.3s",mixColor:"#fff",backgroundColor:" #e4e4e4 ",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"ğŸŒ“",autoMatchOsTheme:!0}).showWidget()}window.addEventListener("load",addDarkmodeWidget)</script></html>